#
# Set the application loader
play {
  modules.enabled += "com.namely.protobuf.chief_of_state.AkkaGrpcClientModule"
  application {
    loader = com.namely.chiefofstate.SidecarApplicationLoader
  }
}

db {
  default {
    driver = "org.postgresql.Driver"
    username = "postgres"
    password = "changeme"
    username = ${?POSTGRES_USER}
    password = ${?POSTGRES_PASSWORD}
    host = "localhost"
    host = ${?POSTGRES_HOST}
    url =  "jdbc:postgresql://"${db.default.host}":5432/postgres"
  }
}

# Defaults to use for each Akka persistence plugin
jdbc-defaults.slick {

  # The Slick profile to use
  # set to one of: slick.jdbc.PostgresProfile$, slick.jdbc.MySQLProfile$, slick.jdbc.OracleProfile$ or slick.jdbc.H2Profile$
  profile = "slick.jdbc.PostgresProfile$"
}

lagom {
  persistence {
    jdbc {
      create-tables {
        auto = true
      }
    }
  }
}

akka {
  persistence {
    journal {
      plugin = "jdbc-journal"
    }
    snapshot-store {
      plugin = "jdbc-snapshot-store"
    }
  }
}

namely {
  service-name = "chiefofstate.service"
  service-name = ${?SERVICE_NAME}
  team = ""
  team = ${?TEAM_NAME}
}

lagom-common {
  snaphsot-criteria {
    # number of events to batch persist
    frequency = 2
    # number of snapshots to retain
    retention = 2
  }

  events {
    # the events tag name. It is recommended to use the service name
    # because the event tag name must be unique and cannot be changed once the application has handled
    # an aggregate event.
    # Reference: https://www.lagomframework.com/documentation/latest/scala/ReadSide.html#Refactoring-Consideration
    tagname: ${namely.service-name}
  }
}